window.Harmony||(window.Harmony={}),Harmony.UI=window.Harmony.UI={LOADING:"loading",OUTPUT:"output",_fields:[],addField:function(a,b,c){if(null!=b){var d=a+(void 0===c||null===c?"":c);Harmony.UI._fields[d]=b.length?b[0]:b}},addressLookup:function(a,b,c,d,e){if(Harmony.UI.addField(Harmony.ADDRESS,a,e),d&&Harmony.UI.addField(Harmony.STATE,d,e),Harmony.UI._checkDependencies()){var f=void 0!==c?c:{};f.source=function(a,c){var f=Harmony.UI._getSourceOfTruth(b),g={fullAddress:Harmony.UI._getFieldValue(Harmony.ADDRESS,e),state:d?Harmony.UI._getFieldValue(Harmony.STATE,e):""}
;Harmony.UI._setLoading(Harmony.ADDRESS,!0),Harmony.address(g,f,function(a){for(var b,d=[],e=0;e<a.payload.length;e++)b=a.payload[e],b.label=b.fullAddress,b.value=b.fullAddress,d[d.length]=b;c(d),Harmony.UI._setLoading(Harmony.ADDRESS,!1)})},f.select=function(c,d){if(a.value=d.item.value,f.skipTransaction)Harmony.UI._setFieldValues(d.item,e);else{var g=Harmony.UI._getSourceOfTruth(b);Harmony.transaction(g,function(){Harmony.UI._setFieldValues(d.item,e)})}f.onSelect&&f.onSelect(c,d)},Harmony.UI._autocomplete(a,f)}},intlAddressLookup:function(a,b,c,d){if(Harmony.UI.addField(Harmony.ADDRESS,a,d),
Harmony.UI.addField(Harmony.COUNTRY,b,d),Harmony.UI._checkDependencies()){var e=void 0!==c?c:{};e.source=function(a,b){var c={fullAddress:Harmony.UI._getFieldValue(Harmony.ADDRESS,d),country:Harmony.UI._getFieldValue(Harmony.COUNTRY,d)};Harmony.UI._setLoading(Harmony.ADDRESS,!0),Harmony.International.address(c,function(a){if("ERROR"!=a.status){for(var c,d=[],e=0;e<a.payload.length;e++)c=a.payload[e],c.label=c.fullAddress,c.value=c.fullAddress,d[d.length]=c;b(d)}Harmony.UI._setLoading(Harmony.ADDRESS,!1)})},e.select=function(b,c){a.value=c.item.value,a.id=c.item.id;var d={id:a.id}
;Harmony.UI._setLoading(Harmony.ADDRESS,!0),Harmony.International.identify(d,function(a){var b=a.payload[0];Harmony.UI._setFieldValue(Harmony.FULL_ADDRESS,b.fullAddress),b.fullAddress=c.item.fullAddress,Harmony.UI._setFieldValues(b),Harmony.UI._setLoading(Harmony.ADDRESS,!1)}),e.onSelect&&e.onSelect(b,c)},Harmony.UI._autocomplete(a,e)}},buildingNameLookup:function(a,b,c){if(Harmony.UI._checkDependencies()){var d=void 0!==c?c:{};Harmony.UI.addField(Harmony.BUILDING_NAME,a),d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.BUILDING_NAME,!0),
Harmony.buildingName(Harmony.UI._getAddress(d),d,function(a){for(var b,d=[],e=0;e<a.payload.length;e++)b=a.payload[e],b.label=b.buildingName+", "+b.streetNumber+" "+b.street+(void 0!==b.locality?", "+b.locality:"")+(void 0!==b.suburb?", "+b.suburb:"")+(void 0!==b.townCity?", "+b.townCity:""),b.value=b.buildingName,d[d.length]=b;c(d),Harmony.UI._setLoading(Harmony.BUILDING_NAME,!1)})},d.select=function(b,c){a.value=c.item.value,c.item.subdwelling="",Harmony.UI._setFieldValues(c.item),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},floorLevelTypeSelect:function(a,b){
var c=Harmony.UI._getSourceOfTruth(b);Harmony.Types.floorLevel(c,function(b){Harmony.UI._populateSelect(a,b)})},localityLookup:function(a,b,c){if(Harmony.UI._checkDependencies()){var d=void 0!==c?c:{};Harmony.UI.addField(Harmony.LOCALITY,a),d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.LOCALITY,!0),Harmony.locality(Harmony.UI._getAddress(d),d,function(a){for(var b,d=[],e=0;e<a.payload.length;e++)b=a.payload[e],b.label=b.locality+" ("+b.postcode+" "+(void 0!==b.townCity?b.townCity:b.state)+")",b.value=b.locality,d[d.length]=b;c(d),
Harmony.UI._setLoading(Harmony.LOCALITY,!1)})},d.select=function(b,c){a.value=c.item.value,Harmony.UI._setFieldValue(Harmony.POSTCODE,c.item.postcode),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},parseAddress:function(){Harmony.UI._setLoading(Harmony.ADDRESS,!0),Harmony.Parse.address(Harmony.UI._getFieldValue(Harmony.ADDRESS),function(a){a.status==Harmony.SUCCESS?null==a.payload[0].exception?(Harmony.UI._clearOutput(),Harmony.UI._setFieldValues(a.payload[0])):(Harmony.UI._clearFieldValues(),Harmony.UI._error(a.payload[0].exception)):Harmony.UI._error(a.message),
Harmony.UI._setLoading(Harmony.ADDRESS,!1)})},cleanseAddress:function(a){Harmony.UI._setLoading(Harmony.ADDRESS,!0),Harmony.Cleanse.address(Harmony.UI._getFieldValue(Harmony.ADDRESS),Harmony.UI._getSourceOfTruth(a),function(a){a.status==Harmony.SUCCESS?null==a.payload[0].exception?(Harmony.UI._clearOutput(),Harmony.UI._setFieldValues(a.payload[0])):(Harmony.UI._clearFieldValues(),Harmony.UI._error(a.payload[0].exception)):Harmony.UI._error(a.message),Harmony.UI._setLoading(Harmony.ADDRESS,!1)})},postalLookup:function(a,b,c){if(Harmony.UI._checkDependencies()){var d=void 0!==c?c:{}
;Harmony.UI.addField(Harmony.POSTAL,a),d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.POSTAL,!0),Harmony.postal(Harmony.UI._getAddress(d),d,function(a){for(var b,d=[],e=0;e<a.payload.length;e++)b=a.payload[e],b.label=b.postal,b.value=b.postal,d[d.length]=b;c(d),Harmony.UI._setLoading(Harmony.POSTAL,!1)})},d.select=function(b,c){a.value=c.item.value,Harmony.UI._setFieldValues(c.item),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},postalTypeSelect:function(a,b){var c=Harmony.UI._getSourceOfTruth(b);Harmony.Types.postal(c,function(b){
Harmony.UI._populateSelect(a,b)})},postcodeLookup:function(a,b,c){if(Harmony.UI.addField(Harmony.POSTCODE,a),Harmony.UI._checkDependencies()){var d=void 0!==c?c:{};d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.POSTCODE,!0),Harmony.postcode(Harmony.UI._getAddress(d),d,function(a){for(var b,d,e=[],f=0;f<a.payload.length;f++)b=a.payload[f],d=void 0!==b.suburb?b.suburb:void 0!==b.locality?b.locality:"",d+=(""!=d?" ":"")+(void 0!==b.townCity?b.townCity:void 0!==b.state?b.state:""),b.label=b.postcode+" ("+d+")",b.value=b.postcode,e[e.length]=b;c(e),
Harmony.UI._setLoading(Harmony.POSTCODE,!1)})},d.select=function(b,c){a.value=c.item.value,Harmony.UI._setFieldValues(c.item),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},setOutputElement:function(a){Harmony.UI.addField(Harmony.UI.OUTPUT,a)},streetLookup:function(a,b,c){if(Harmony.UI.addField(Harmony.STREET,a),Harmony.UI._checkDependencies()){var d=void 0!==c?c:{};d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.STREET,!0),Harmony.street(Harmony.UI._getAddress(d),d,function(a){for(var b=[],d=0;d<a.payload.length;d++){var e=a.payload[d]
;e.label=e.street+", "+(void 0!==e.suburb?e.suburb:e.locality),e.value=e.street,b[b.length]=e}c(b),Harmony.UI._setLoading(Harmony.STREET,!1)})},d.select=function(b,c){a.value=c.item.value,Harmony.UI._setFieldValues(c.item),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},streetNumberLookup:function(a,b,c){if(Harmony.UI.addField(Harmony.STREET_NUMBER,a),Harmony.UI._checkDependencies()){var d=void 0!==c?c:{};d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.STREET_NUMBER,!0),Harmony.streetNumber(Harmony.UI._getAddress(d),d,function(a){
for(var b,d=[],e=0;e<a.payload.length;e++)b=a.payload[e],b.label=b.streetNumber+" "+b.street,b.value=jQuery.trim(b.streetNumber),d[d.length]=b;c(d),Harmony.UI._setLoading(Harmony.STREET_NUMBER,!1)})},d.select=function(b,c){a.value=c.item.value,c.item.subdwelling="",Harmony.UI._setFieldValues(c.item),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},streetSuffixTypeSelect:function(a,b){var c=Harmony.UI._getSourceOfTruth(b);Harmony.Types.streetSuffix(c,function(b){Harmony.UI._populateSelect(a,b)})},streetTypeSelect:function(a,b){var c=Harmony.UI._getSourceOfTruth(b)
;Harmony.Types.street(c,function(b){Harmony.UI._populateSelect(a,b)})},subdwellingLookup:function(a,b,c){if(Harmony.UI.addField(Harmony.SUBDWELLING,a),Harmony.UI._checkDependencies()){var d=void 0!==c?c:{};d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.SUBDWELLING,!0),Harmony.subdwelling(Harmony.UI._getAddress(d),d,function(a){for(var b,d=[],e=0;e<a.payload.length;e++)b=a.payload[e],b.label=b.fullAddress,b.value=jQuery.trim(b.subdwelling),d[d.length]=b;c(d),Harmony.UI._setLoading(Harmony.SUBDWELLING,!1)})},d.select=function(b,c){
a.value=c.item.value,Harmony.UI._setFieldValues(c.item),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},suburbLookup:function(a,b,c){if(Harmony.UI.addField(Harmony.SUBURB,a),Harmony.UI._checkDependencies()){var d=void 0!==c?c:{};d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.SUBURB,!0),Harmony.suburb(Harmony.UI._getAddress(d),d,function(a){for(var b,d=[],e=0;e<a.payload.length;e++)b=a.payload[e],b.label=b.suburb+", "+b.townCity+" ("+b.postcode+")",b.value=b.suburb,d[d.length]=b;c(d),Harmony.UI._setLoading(Harmony.SUBURB,!1)})},
d.select=function(b,c){a.value=c.item.value,Harmony.UI._setFieldValues(c.item),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},townCityLookup:function(a,b,c){if(Harmony.UI.addField(Harmony.TOWN_CITY,a),Harmony.UI._checkDependencies()){var d=void 0!==c?c:{};d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b);Harmony.UI._setLoading(Harmony.TOWN_CITY,!0),Harmony.townCity(Harmony.UI._getAddress(d),d,function(a){for(var b,d=[],e=0;e<a.payload.length;e++)b=a.payload[e],b.label=b.townCity+" ("+(""!=b.suburb?b.suburb+", ":"")+b.postcode+")",b.value=b.townCity,d[d.length]=b;c(d),
Harmony.UI._setLoading(Harmony.TOWN_CITY,!1)})},d.select=function(b,c){a.value=c.item.value,Harmony.UI._setFieldValues(c.item),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},advancedLocalityLookup:function(a,b,c){if(Harmony.UI._checkDependencies()){var d=void 0!==c?c:{};Harmony.UI.addField(Harmony.LOCALITY,a),d.source=function(a,c){var d=Harmony.UI._getSourceOfTruth(b),e={fullAddress:Harmony.UI._getFieldValue(Harmony.LOCALITY)};Harmony.UI._setLoading(Harmony.LOCALITY,!0),Harmony.locality(e,d,function(a){for(var b,d=[],e=0;e<a.payload.length;e++){if(b=a.payload[e],
b.attributes&&b.attributes.regional_council_name){b.region=b.attributes.regional_council_name;var f=b.fullAddress.lastIndexOf(" ");f>0&&(b.fullAddress=b.fullAddress.substring(0,f).trim()+", "+b.region+b.fullAddress.substring(f))}b.label=b.fullAddress,b.value=b.locality||b.suburb||b.postal,d[d.length]=b}c(d),Harmony.UI._setLoading(Harmony.LOCALITY,!1)})},d.select=function(b,c){a.value=c.item.value,Harmony.UI._setFieldValues(c.item),d.onSelect&&d.onSelect(b,c)},Harmony.UI._autocomplete(a,d)}},unitFlatTypeSelect:function(a,b){var c=Harmony.UI._getSourceOfTruth(b)
;Harmony.Types.unitFlat(c,function(b){Harmony.UI._populateSelect(a,b)})},identifyAddress:function(){Harmony.UI._setLoading(Harmony.EID,!0),Harmony.Extensions.identify({eid:Harmony.UI._getFieldValue(Harmony.EID)},function(a){null!=a?Harmony.UI._setFieldValues(a.payload[0]):Harmony.UI._error("Failed to identify address"),Harmony.UI._setLoading(Harmony.EID,!1)})},_addSelectOption:function(a,b,c){var d=document.createElement("option");d.text=b,d.value=c,a.add(d)},_autocomplete:function(a,b){jQuery(a).autocomplete(b)},_checkDependencies:function(){var a=!0
;return window.Harmony||(alert("Harmony JavaScript library is required"),a=!1),window.jQuery||(alert("jQuery is required"),a=!1),void 0!==jQuery.autocomplete&&(alert("jQuery UI Autocomplete is required"),a=!1),a},_clearFieldValues:function(){Harmony.UI._setFieldValues({})},_clearOutput:function(){Harmony.UI._error("")},_error:function(a){var b=Harmony.UI._getField(Harmony.UI.OUTPUT);null!=b&&(void 0!==b.value?b.value=a:jQuery(b).html(a))},_getAddress:function(a){var b=Harmony.UI._getSourceOfTruthCountry(a),c={}
;return null!=Harmony.UI._getField(Harmony.POSTCODE)&&(c.postcode=Harmony.UI._getFieldValue(Harmony.POSTCODE)),b==Harmony.AUSTRALIA&&null!=Harmony.UI._getField(Harmony.LOCALITY)&&(c.locality=Harmony.UI._getFieldValue(Harmony.LOCALITY)),b==Harmony.NEW_ZEALAND&&null!=Harmony.UI._getField(Harmony.TOWN_CITY)&&(c.townCity=Harmony.UI._getFieldValue(Harmony.TOWN_CITY)),b==Harmony.NEW_ZEALAND&&null!=Harmony.UI._getField(Harmony.SUBURB)&&(c.suburb=Harmony.UI._getFieldValue(Harmony.SUBURB),c.locality=c.suburb),
null!=Harmony.UI._getField(Harmony.STREET)&&(c.street=Harmony.UI._getFieldValue(Harmony.STREET)),null!=Harmony.UI._getField(Harmony.STREET_NUMBER)&&(c.streetNumber=Harmony.UI._getFieldValue(Harmony.STREET_NUMBER)),null!=Harmony.UI._getField(Harmony.SUBDWELLING)&&(c.subdwelling=Harmony.UI._getFieldValue(Harmony.SUBDWELLING)),null!=Harmony.UI._getField(Harmony.POSTAL)&&(c.postal=Harmony.UI._getFieldValue(Harmony.POSTAL)),null!=Harmony.UI._getField(Harmony.BUILDING_NAME)&&(c.buildingName=Harmony.UI._getFieldValue(Harmony.BUILDING_NAME)),c},_getField:function(a,b){var c=void 0===b||null===b?"":b
;return Harmony.UI._fields[a+c]},_getFieldValue:function(a,b){var c=jQuery(Harmony.UI._getField(a,b)),d="";return c&&c.length&&(d=c.val()),d},_getSourceOfTruth:function(a){var b=Harmony.UI._getFieldValue(Harmony.SOURCE_OF_TRUTH);return void 0!==b&&""!=b||(b=a),b},_getSourceOfTruthCountry:function(a){var b=null;return a==Harmony.AUSOTS||a==Harmony.AUPAF||a==Harmony.GNAF?b=Harmony.AUSTRALIA:a==Harmony.NZPAF&&(b=Harmony.NEW_ZEALAND),b},_populateSelect:function(a,b){var c
;if(void 0!==b&&void 0!==b.payload)for(c=0;c<b.payload.length;c++)Harmony.UI._addSelectOption(a,b.payload[c].name,b.payload[c].value);else Harmony.UI._addSelectOption(a,"No data available",0)},_setFieldValue:function(a,b,c){var d=Harmony.UI._getField(a,c);null!=d&&(d.value=void 0!==b?b:"")},_setFieldValues:function(a,b){var c="";if(void 0!==a){Harmony.UI._setFieldValue(Harmony.EID,a.eid,b),Harmony.UI._setFieldValue(Harmony.POSTCODE,a.postcode,b),Harmony.UI._setFieldValue(Harmony.STATE,a.state,b),Harmony.UI._setFieldValue(Harmony.LOCALITY,a.locality,b),
Harmony.UI._setFieldValue(Harmony.TOWN_CITY,a.townCity,b),Harmony.UI._setFieldValue(Harmony.SUBURB,a.suburb,b),Harmony.UI._setFieldValue(Harmony.STREET,a.street,b),Harmony.UI._setFieldValue(Harmony.STREET_2,a.street2,b),Harmony.UI._setFieldValue(Harmony.STREET_NUMBER,a.streetNumber,b),Harmony.UI._setFieldValue(Harmony.POSTAL,a.postal,b),Harmony.UI._setFieldValue(Harmony.BUILDING_NAME,a.buildingName,b),Harmony.UI._setFieldValue(Harmony.SUBDWELLING,a.subdwelling,b),Harmony.UI._setFieldValue(Harmony.ADDRESS,a.fullAddress,b),Harmony.UI._setFieldValue(Harmony.ID,a.id,b),
Harmony.UI._setFieldValue(Harmony.FLOOR_LEVEL_TYPE,a.floorLevelType,b),Harmony.UI._setFieldValue(Harmony.FLOOR_LEVEL_NUMBER,a.floorLevelNumber,b),Harmony.UI._setFieldValue(Harmony.FLAT_UNIT_TYPE,a.flatUnitType,b),Harmony.UI._setFieldValue(Harmony.FLAT_UNIT_NUMBER,a.flatUnitNumber,b),Harmony.UI._setFieldValue(Harmony.LOT_NUMBER,a.lotNumber,b),Harmony.UI._setFieldValue(Harmony.STREET_NAME,a.streetName,b),Harmony.UI._setFieldValue(Harmony.STREET_TYPE,a.streetType,b),Harmony.UI._setFieldValue(Harmony.STREET_SUFFIX,a.streetSuffix,b),Harmony.UI._setFieldValue(Harmony.POSTAL_TYPE,a.postalType,b),
Harmony.UI._setFieldValue(Harmony.POSTAL_NUMBER,a.postalNumber,b),Harmony.UI._setFieldValue(Harmony.CITY,a.city,b),Harmony.UI._setFieldValue(Harmony.PROVINCE,a.province,b),Harmony.UI._setFieldValue(Harmony.DISTRICT,a.district,b);for(var d in a.attributes)c+=(""==c?"":", ")+d+": "+a.attributes[d];Harmony.UI._setFieldValue(Harmony.ATTRIBUTES,c,b)}},_setLoading:function(a,b){var c=jQuery(Harmony.UI._getField(a));b?c.addClass(Harmony.UI.LOADING):c.removeClass(Harmony.UI.LOADING)}};